<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Information</title>
    <link rel="stylesheet" href="styles/popup.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>üìä Stock Info</h1>
            <p id="subtitle">Real-time stock data and charts</p>
        </div>
        
        <!-- Tab Navigation -->
        <div class="tab-navigation">
            <button class="tab-btn active" data-tab="basic">üìà Basic Info</button>
            <button class="tab-btn" data-tab="advanced">üìä Advanced</button>
            <button class="tab-btn" data-tab="quarterly">üìà Quarterly Trends</button>
        </div>
        
        <!-- Clear Button - Always Visible -->
        <div style="padding: 8px; text-align: center; border-bottom: 1px solid rgba(255,255,255,0.1);">
            <button id="clearDataBtn" class="secondary-btn" style="font-size: 11px; padding: 6px 12px;">üßπ Clear & Start Fresh</button>
        </div>
        
        <!-- Tab Content Container -->
        <div class="tab-content">
            <!-- Basic Info Tab -->
            <div id="basic-tab" class="tab-panel active">
                <!-- Loading State -->
                <div id="loading" class="loading hidden">
                    <div class="spinner"></div>
                    <p>Fetching stock data...</p>
                </div>
                
                <!-- Stock Data Display -->
                <div id="stockData" class="stock-data hidden">
            <!-- Stock Information -->
            <div class="stock-info">
                <div class="stock-symbol" id="stockSymbol">AAPL</div>
                <div class="stock-price" id="stockPrice">$150.00</div>
                <div class="stock-change" id="stockChange">+$2.50 (+1.69%)</div>
                
                <div class="stock-details">
                    <div class="detail-row">
                        <span class="label">Day High:</span>
                        <span class="value">$152.00</span>
                    </div>
                    <div class="detail-row">
                        <span class="label">Day Low:</span>
                        <span class="value">$148.50</span>
                    </div>
                    <div class="detail-row">
                        <span class="label">Market Cap:</span>
                        <span class="value">$2.4T</span>
                    </div>
                </div>
                
                <!-- External Links -->
                <div class="links">
                    <a id="yahooLink" href="#" target="_blank" class="link-btn">üìà Yahoo</a>
                    <a id="googleLink" href="#" target="_blank" class="link-btn">üîç Google</a>
                </div>
            </div>
            
            <!-- Chart Section -->
            <div class="chart-section">
                <div class="chart-controls">
                    <div class="period-buttons">
                        <button class="period-btn active" data-period="1d">1D</button>
                        <button class="period-btn" data-period="5d">5D</button>
                        <button class="period-btn" data-period="1mo">1M</button>
                        <button class="period-btn" data-period="6mo">6M</button>
                        <button class="period-btn" data-period="1y">1Y</button>
                    </div>
                </div>
                <canvas id="stockChart" width="340" height="150"></canvas>
            </div>
        </div>

        <!-- Gemini AI Analysis - COMMENTED OUT FOR NOW -->
        <!-- <div id="geminiAiAnalysis" class="gemini-analysis hidden">
            <h3>ü§ñ AI-Powered Analysis with Gemini</h3>
            <div id="chatContainer" class="chat-container">
                <!-- Chat messages will be appended here -->
            </div>
            <div class="chat-input-group">
                <input type="text" id="chatInput" placeholder="Ask about cash flow, revenue, etc...">
                <button id="sendChatBtn" class="action-btn">‚úâÔ∏è Send</button>
            </div>
        </div> -->
        
        <!-- Auto-Detection -->
        <div id="autoDetection" class="auto-detection hidden">
            <h3>üéØ Stock Detected</h3>
            <div class="detected-ticker" id="detectedTicker">AAPL</div>
            <button id="autoBtn" class="action-btn">üìä Get Stock Info</button>
        </div>
        
        <!-- Manual Input -->
        <div id="manualInput" class="manual-input hidden">
            <h3>üîç Search Stock</h3>
            <div class="input-group">
                <input type="text" id="tickerInput" placeholder="Enter ticker (e.g., AAPL)" maxlength="6">
                <button id="searchBtn" class="action-btn">üîç</button>
            </div>
            
            <!-- Popular Stocks -->
            <div class="popular-stocks">
                <h4>Popular Stocks:</h4>
                <div class="ticker-buttons">
                    <button class="ticker-btn" data-ticker="AAPL">AAPL</button>
                    <button class="ticker-btn" data-ticker="MSFT">MSFT</button>
                    <button class="ticker-btn" data-ticker="GOOGL">GOOGL</button>
                    <button class="ticker-btn" data-ticker="AMZN">AMZN</button>
                    <button class="ticker-btn" data-ticker="TSLA">TSLA</button>
                    <button class="ticker-btn" data-ticker="NVDA">NVDA</button>
                </div>
            </div>
        </div>

        <!-- Ticker Suggestions -->
        <div id="tickerSuggestions" class="manual-input hidden">
            <h3>ü§î Did you mean?</h3>
            <div id="suggestionButtons">
                <!-- Suggestion buttons will be appended here -->
            </div>
        </div>
        
                <!-- Instructions -->
                <div id="instructions" class="instructions">
                    <h3>üéØ How to Use</h3>
                    <p>
                        ‚Ä¢ Select stock text on any page<br>
                        ‚Ä¢ Right-click ‚Üí "Get Stock Information" (auto-opens!)<br>
                        ‚Ä¢ Or type a ticker symbol above
                    </p>
                </div>
            </div> <!-- End Basic Tab -->

            <!-- Advanced Tab -->
            <div id="advanced-tab" class="tab-panel hidden">
                <!-- Advanced Loading State -->
                <div id="advancedLoading" class="loading hidden">
                    <div class="spinner"></div>
                    <p>Fetching financial data...</p>
                </div>
                
                <!-- Financial Data Display -->
                <div id="financialData" class="financial-data hidden">
                    <!-- Company Overview -->
                    <div class="financial-section">
                        <h3>üìã Company Overview</h3>
                        <div class="financial-grid">
                            <div class="financial-item">
                                <span class="financial-label">Shares Outstanding:</span>
                                <span class="financial-value" id="sharesOutstanding">-</span>
                            </div>
                            <div class="financial-item">
                                <span class="financial-label">Market Cap:</span>
                                <span class="financial-value" id="marketCapAdvanced">-</span>
                            </div>
                            <div class="financial-item">
                                <span class="financial-label">Enterprise Value:</span>
                                <span class="financial-value" id="enterpriseValue">-</span>
                            </div>
                            <div class="financial-item">
                                <span class="financial-label">YTD Return:</span>
                                <span class="financial-value" id="ytdReturn">-</span>
                            </div>
                        </div>
                    </div>

                    <!-- Financial Performance -->
                    <div class="financial-section">
                        <h3>üí∞ Financial Performance (TTM)</h3>
                        <div class="financial-grid">
                            <div class="financial-item">
                                <span class="financial-label">Revenue:</span>
                                <span class="financial-value" id="totalRevenue">-</span>
                            </div>
                            <div class="financial-item">
                                <span class="financial-label">EBITDA:</span>
                                <span class="financial-value" id="ebitda">-</span>
                            </div>
                            <div class="financial-item">
                                <span class="financial-label">Net Income:</span>
                                <span class="financial-value" id="netIncome">-</span>
                            </div>
                            <div class="financial-item">
                                <span class="financial-label">Free Cash Flow:</span>
                                <span class="financial-value" id="freeCashFlow">-</span>
                            </div>
                            <div class="financial-item">
                                <span class="financial-label">EPS (TTM):</span>
                                <span class="financial-value" id="eps">-</span>
                            </div>
                            <div class="financial-item">
                                <span class="financial-label">Operating Expenses:</span>
                                <span class="financial-value" id="operatingExpenses">-</span>
                            </div>
                        </div>
                    </div>

                    <!-- Balance Sheet -->
                    <div class="financial-section">
                        <h3>üè¶ Balance Sheet</h3>
                        <div class="financial-grid">
                            <div class="financial-item">
                                <span class="financial-label">Total Cash:</span>
                                <span class="financial-value" id="totalCash">-</span>
                            </div>
                            <div class="financial-item">
                                <span class="financial-label">Total Debt:</span>
                                <span class="financial-value" id="totalDebt">-</span>
                            </div>
                            <div class="financial-item">
                                <span class="financial-label">Net Debt:</span>
                                <span class="financial-value" id="netDebt">-</span>
                            </div>
                            <div class="financial-item">
                                <span class="financial-label">Book Value:</span>
                                <span class="financial-value" id="bookValue">-</span>
                            </div>
                        </div>
                    </div>

                    <!-- Valuation Ratios -->
                    <div class="financial-section">
                        <h3>üìä Valuation Ratios</h3>
                        <div class="financial-grid">
                            <div class="financial-item">
                                <span class="financial-label">P/E Ratio:</span>
                                <span class="financial-value" id="peRatio">-</span>
                            </div>
                            <div class="financial-item">
                                <span class="financial-label">P/B Ratio:</span>
                                <span class="financial-value" id="pbRatio">-</span>
                            </div>
                            <div class="financial-item">
                                <span class="financial-label">EV/Revenue:</span>
                                <span class="financial-value" id="evRevenue">-</span>
                            </div>
                            <div class="financial-item">
                                <span class="financial-label">EV/EBITDA:</span>
                                <span class="financial-value" id="evEbitda">-</span>
                            </div>
                            <div class="financial-item">
                                <span class="financial-label">ROE:</span>
                                <span class="financial-value" id="roe">-</span>
                            </div>
                            <div class="financial-item">
                                <span class="financial-label">ROA:</span>
                                <span class="financial-value" id="roa">-</span>
                            </div>
                        </div>
                    </div>

                </div>

                <!-- Advanced Instructions -->
                <div id="advancedInstructions" class="instructions">
                    <h3>üìä Advanced Financial Analysis</h3>
                    <p>
                        ‚Ä¢ Comprehensive financial metrics and ratios<br>
                        ‚Ä¢ Trailing twelve months (TTM) performance<br>
                        ‚Ä¢ Balance sheet and cash flow analysis<br>
                        ‚Ä¢ Valuation ratios and profitability metrics
                    </p>
                </div>
            </div> <!-- End Advanced Tab -->
            
            <!-- Quarterly Trends Tab -->
            <div id="quarterly-tab" class="tab-panel hidden">
                <!-- Loading State -->
                <div id="quarterlyLoading" class="loading hidden">
                    <div class="spinner"></div>
                    <p>Analyzing quarterly trends...</p>
                </div>

                <!-- Quarterly Controls -->
                <div class="quarterly-controls">
                    <button id="loadQuarterlyBtn" class="primary-btn">üìà Load Quarterly Analysis</button>
                    <div class="control-info">
                        <span>Historical quarterly data and growth trends</span>
                    </div>
                </div>

                <!-- Quarterly Data Container -->
                <div id="quarterlyContainer" class="quarterly-container hidden">
                    
                    <!-- AI Analysis Section -->
                    <div class="ai-analysis-section">
                        <h3>ü§ñ AI Financial Analysis</h3>
                        <div id="aiAnalysisContainer" class="ai-analysis-container">
                            <div id="aiAnalysisLoading" class="ai-analysis-loading hidden">
                                <div class="ai-spinner"></div>
                                <span>Analyzing quarterly data with AI...</span>
                            </div>
                            <div id="aiAnalysisContent" class="ai-analysis-content hidden">
                                <!-- AI analysis will be populated here -->
                            </div>
                            <div id="aiAnalysisError" class="ai-analysis-error hidden">
                                <p>AI analysis unavailable. Please ensure Gemini API key is configured.</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Key Insights Dashboard -->
                    <div class="quarterly-insights">
                        <h3>üí° Key Financial Insights</h3>
                        <div id="quarterlyInsights" class="insights-grid">
                            <!-- Insights will be populated here -->
                        </div>
                    </div>

                    <!-- Visual Charts Section -->
                    <div class="quarterly-charts-section">
                        <h3>üìà Visual Trends Analysis</h3>
                        
                        <!-- Chart Controls -->
                        <div class="chart-selector">
                            <button class="chart-btn active" data-chart="revenue">üìä Revenue</button>
                            <button class="chart-btn" data-chart="cashflow">üí∏ Cash Flow</button>
                            <button class="chart-btn" data-chart="margins">üìà Margins</button>
                        </div>
                        
                        <!-- Chart Canvas -->
                        <div class="chart-container">
                            <canvas id="quarterlyChart" width="420" height="200"></canvas>
                            <div id="chartLegend" class="chart-legend">
                                <!-- Legend will be populated here -->
                            </div>
                        </div>
                    </div>

                    <!-- Detailed Tables Section -->
                    <div class="quarterly-tables">
                        <h3>üìã Detailed Financial Tables</h3>
                        
                        <!-- Revenue & Profitability -->
                        <div class="quarterly-table-section">
                            <h4>üí∞ Revenue & Profitability Trends</h4>
                            <div id="revenueTable" class="quarterly-table">
                                <!-- Table will be populated here -->
                            </div>
                        </div>
                        
                        <!-- Cash Flow Analysis -->
                        <div class="quarterly-table-section">
                            <h4>üí∏ Cash Flow Analysis</h4>
                            <div id="cashFlowTable" class="quarterly-table">
                                <!-- Table will be populated here -->
                            </div>
                        </div>
                        
                        <!-- Balance Sheet Evolution -->
                        <div class="quarterly-table-section">
                            <h4>üè¶ Balance Sheet Evolution</h4>
                            <div id="balanceSheetTable" class="quarterly-table">
                                <!-- Table will be populated here -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- Growth Metrics Summary -->
                    <div class="growth-analysis">
                        <h3>üìä Growth Metrics Summary</h3>
                        <div id="growthMetrics" class="growth-metrics">
                            <!-- Growth metrics will be populated here -->
                        </div>
                    </div>
                </div>
                
                <!-- Quarterly Error State -->
                <div id="quarterlyError" class="quarterly-error hidden">
                    <p>‚ö†Ô∏è Unable to load quarterly data. This may be due to limited data availability for this ticker.</p>
                </div>

                <!-- Quarterly Instructions -->
                <div id="quarterlyInstructions" class="instructions">
                    <h3>üìà Quarterly Trends Analysis</h3>
                    <p>
                        ‚Ä¢ Historical quarterly financial performance<br>
                        ‚Ä¢ Interactive charts showing revenue, cash flow, and margins<br>
                        ‚Ä¢ Quarter-over-quarter and year-over-year growth analysis<br>
                        ‚Ä¢ Automated financial insights and trend detection
                    </p>
                </div>
            </div> <!-- End Quarterly Tab -->
        </div> <!-- End Tab Content -->
    </div> <!-- End Container -->
    
    <script src="popup-tabbed.js"></script>
</body>
</html>
